"use strict";(self.webpackChunkreact_social_media_2=self.webpackChunkreact_social_media_2||[]).push([[266],{266:function(e,a,s){s.r(a);var t=s(9439),r=s(2791),c=s(1458),n=s(3900),i=s(2058),l=s(4123),u=s(1087),o=s(184);a.default=function(){var e=(0,r.useRef)(null),a=(0,r.useContext)(c.Z),s=(0,r.useContext)(n.Z),h=(0,r.useRef)(null),f=(0,r.useRef)(null),m=(0,i.x)({fieldValue:"",chatMessages:[]}),d=(0,t.Z)(m,2),p=d[0],v=d[1];(0,r.useEffect)((function(){return e.current=(0,l.io)("http://localhost:8080"),e.current.removeAllListeners(),e.current.on("chatFromServer",(function(e){v((function(a){a.chatMessages.push(e)}))})),function(){return e.current.disconnect()}}),[]),(0,r.useEffect)((function(){a.isChatOpen&&(h.current.focus(),s({type:"clearUnreadChatCount"}))}),[a.isChatOpen]),(0,r.useEffect)((function(){f.current.scrollTop=f.current.scrollHeight,p.chatMessages.length&&!a.isChatOpen&&s({type:"incrementUnreadChatCount"})}),[p.chatMessages]);return(0,o.jsxs)("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right "+(a.isChatOpen?"chat-wrapper--is-visible":""),children:[(0,o.jsxs)("div",{className:"chat-title-bar bg-primary",children:["Chat",(0,o.jsx)("span",{onClick:function(){return s({type:"closeChat"})},className:"chat-title-bar-close",children:(0,o.jsx)("i",{className:"fas fa-times-circle"})})]}),(0,o.jsx)("div",{id:"chat",className:"chat-log",ref:f,children:p.chatMessages.map((function(e,s){return e.username===a.user.username?(0,o.jsxs)("div",{className:"chat-self",children:[(0,o.jsx)("div",{className:"chat-message",children:(0,o.jsx)("div",{className:"chat-message-inner",children:e.message})}),(0,o.jsx)("img",{className:"chat-avatar avatar-tiny",src:e.avatar,alt:"profile avatar"})]},s):(0,o.jsxs)("div",{className:"chat-other",children:[(0,o.jsx)(u.rU,{to:"/profile/".concat(e.username),children:(0,o.jsx)("img",{className:"avatar-tiny",src:e.avatar})}),(0,o.jsx)("div",{className:"chat-message",children:(0,o.jsxs)("div",{className:"chat-message-inner",children:[(0,o.jsx)(u.rU,{to:"/profile/".concat(e.username),children:(0,o.jsxs)("strong",{children:[e.username,": "]})}),e.message]})})]},s)}))}),(0,o.jsx)("form",{onSubmit:function(s){s.preventDefault(),e.current.emit("chatFromBrowser",{message:p.fieldValue,token:a.user.token}),v((function(e){e.chatMessages.push({message:e.fieldValue,username:a.user.username,avatar:a.user.avatar}),e.fieldValue=""}))},id:"chatForm",className:"chat-form border-top",children:(0,o.jsx)("input",{value:p.fieldValue,onChange:function(e){var a=e.target.value;v((function(e){e.fieldValue=a}))},ref:h,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a message\u2026",autoComplete:"off"})})]})}}}]);
//# sourceMappingURL=266.e623c0e9.chunk.js.map