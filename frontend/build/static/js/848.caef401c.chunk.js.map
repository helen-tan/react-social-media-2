{"version":3,"file":"static/js/848.caef401c.chunk.js","mappings":"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","sources":["components/ViewSinglePost.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport { useParams, Link, useNavigate } from 'react-router-dom'\r\nimport Axios from 'axios'\r\nimport Page from './Page'\r\nimport LoadingDotsIcon from './LoadingDotsIcon'\r\nimport NotFound from './NotFound'\r\nimport { ReactMarkdown } from 'react-markdown/lib/react-markdown'\r\nimport { Tooltip } from 'react-tooltip'\r\nimport 'react-tooltip/dist/react-tooltip.css';\r\nimport StateContext from '../StateContext'\r\nimport DispatchContext from '../DispatchContext'\r\n\r\nconst ViewSinglePost = () => {\r\n    const [loading, setLoading] = useState(true)\r\n    const [post, setPost] = useState()\r\n    const { id } = useParams()\r\n\r\n    const globalState = useContext(StateContext)\r\n    const globalDispatch = useContext(DispatchContext)\r\n\r\n    const navigate = useNavigate()\r\n\r\n    useEffect(() => {\r\n     \r\n        const ourRequest = Axios.CancelToken.source() // A way of identifying an Axios request\r\n\r\n        async function fetchPost() {\r\n            try {\r\n                const response = await Axios.get(`/post/${id}`, { cancelToken: ourRequest.token })\r\n                // console.log(response.data)\r\n                setPost(response.data)\r\n                setLoading(false)\r\n            } catch (err) {\r\n                console.log(\"There was a problem, or the request was cancelled.\")\r\n            }\r\n        }\r\n\r\n        fetchPost()\r\n\r\n        // Cleanup - prevent memory leak (update of state after this component is unmounted/stops being rendered)\r\n        return () => {\r\n            // Cancel the Axios request\r\n            ourRequest.cancel()\r\n        }\r\n    }, [id])\r\n\r\n    const isOwner = () => {\r\n        // If not logged in = not owner\r\n        if (globalState.loggedIn) {\r\n            return globalState.user.username === post.author.username\r\n        } else return false\r\n    }\r\n\r\n    const handleDelete = async () => {\r\n        const areYouSure = window.confirm(\"Do you really want to delete this post?\")\r\n        if (areYouSure) {\r\n            try {\r\n                const response = await Axios.delete(`/post/${id}`, { data: { token: globalState.user.token } })\r\n                if (response.data === \"Success\") {\r\n                    // 1. Display flash message\r\n                    globalDispatch({ type: \"flashMessage\", value: { message: \"Post was successfully deleted.\", color: \"success\" } })\r\n                    // 2. Redirect back to current user's profile\r\n                    navigate(`/profile/${globalState.user.username}`)\r\n                }\r\n            } catch (err) {\r\n                console.log(\"There was a problem\")\r\n            }\r\n        }\r\n    }\r\n\r\n    if (!loading && !post) { // if loading is completed & post is undefined (evaluated to false bcos server couldn't find anything)\r\n        return <NotFound />\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <Page title=\"...\">\r\n                <LoadingDotsIcon />\r\n            </Page>\r\n        )\r\n    }\r\n\r\n    const date = new Date(post.createdDate)\r\n    const dateFormatted = `${date.getMonth() + 1}/${date.getDate()}/${date.getFullYear()}`\r\n\r\n    return (\r\n        <Page title={post.title}>\r\n            <div className=\"d-flex justify-content-between\">\r\n                <h2>{post.title}</h2>\r\n\r\n                {isOwner() && (\r\n                    <span className=\"pt-2\">\r\n                        <Link to={`/post/${post._id}/edit`} data-tooltip-id=\"edit-tooltip\" data-tooltip-content=\"Edit\" className=\"text-primary mr-2\">\r\n                            <i className=\"fas fa-edit\"></i>\r\n                        </Link>\r\n                        <Tooltip id=\"edit-tooltip\" place=\"top\" className=\"custom-tooltip\" />\r\n\r\n                        {\" \"}\r\n\r\n                        <a onClick={handleDelete} data-tooltip-id=\"delete-tooltip\" data-tooltip-content=\"Delete\" className=\"delete-post-button text-danger\">\r\n                            <i className=\"fas fa-trash\"></i>\r\n                        </a>\r\n                        <Tooltip id=\"delete-tooltip\" place=\"top\" className=\"custom-tooltip\" />\r\n                    </span>\r\n                )}\r\n            </div>\r\n\r\n            <p className=\"text-muted small mb-4\">\r\n                <Link to={`/profile/${post.author.username}`}>\r\n                    <img className=\"avatar-tiny\" src={post.author.avatar} />\r\n                </Link>\r\n                Posted by <Link to={`/profile/${post.author.username}`}>{post.author.username}</Link> on {dateFormatted}\r\n            </p>\r\n\r\n            <div className=\"body-content\">\r\n                <ReactMarkdown\r\n                    children={post.body}\r\n                    allowedElements={[\"p\", \"br\", \"strong\", \"em\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"ul\", \"ol\", \"li\"]}\r\n                />\r\n            </div>\r\n        </Page>\r\n    )\r\n}\r\n\r\nexport default ViewSinglePost"],"names":["_useState","useState","_useState2","_slicedToArray","loading","setLoading","_useState3","_useState4","post","setPost","id","useParams","globalState","useContext","StateContext","globalDispatch","DispatchContext","navigate","useNavigate","useEffect","ourRequest","Axios","_fetchPost","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_context","prev","next","concat","cancelToken","token","sent","data","t0","console","log","stop","apply","arguments","fetchPost","cancel","handleDelete","_ref","_callee2","_context2","window","confirm","user","type","value","message","color","username","_jsx","NotFound","Page","title","children","LoadingDotsIcon","date","Date","createdDate","dateFormatted","getMonth","getDate","getFullYear","_jsxs","className","loggedIn","author","Link","to","_id","Tooltip","place","onClick","src","avatar","ReactMarkdown","body","allowedElements"],"sourceRoot":""}